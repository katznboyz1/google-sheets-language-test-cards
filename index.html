<!DOCTYPE html>
<html lang = 'en'>
    <head>
        <meta charset = 'utf-8'/>
        <meta content = 'Google Sheets Test Card Generator' property = 'og:title'/>
        <meta content = 'Test your language skills using your own Google Sheets, in flash card form!' property = 'og:site_name'/>
        <meta content = 'This site allows you to enter a Google Sheets URL, and then it generates test cards based on the content in the sheet.' property = 'og:description'/>
        <meta content = '#59fa4d' data-react-helpet = 'true' name = 'theme-color'/>

        <link rel = 'stylesheet' href = './utils/bootstrap-4.1.3.min.css'/>
        <link rel = 'stylesheet' href = './utils/index.html.css'/>

        <title>Google Sheets Test Card Generator</title>

        <script src = './utils/jquery-3.3.1.min.js'></script>
        <script src = './utils/popper-1.14.3.min.js'></script>
        <script src = './utils/bootstrap-4.1.3.min.js'></script>

        <script>
            const GOOGLE_SHEET_URL_ELEMENT_ID = 'google-sheet-url';

            let googleSheetData;

            function parseGoogleSheetURL() {
                let googleSheetURLUnparsed = document.getElementById(GOOGLE_SHEET_URL_ELEMENT_ID).value;

                $.ajax({
                    headers: {'Accept':'text/csv'},
                    type: 'GET',
                    url: 'https://docs.google.com/spreadsheets/d/' + String(googleSheetURLUnparsed) + '/export?format=csv',
                    crossDomain: true,
                    beforeSend: function(xhr) {
                        xhr.withCredentials = true;
                    }, success: function(data, textStatus, request) {
                        console.log('success');
                    }
                })
            }
        </script>
    </head>
    <body>
        <div class = 'container-fluid mx-0'>
            <div class = 'row col-lg-12 mx-0'>
                <div class = 'd-flex col-lg-12 vh-100 justify-content-center big-divs'>
                    <div class = 'col-lg-12 form-horizontal my-auto'>
                        <div class = 'd-flex form-group col-lg-6 col-md-12 mx-auto'>
                            <h1 class = 'mx-auto center-text'>
                                Google Sheets Test Card Generator
                            </h1>
                        </div>
                        <div class = 'd-flex form-group col-lg-6 col-md-12 mx-auto header-margin-1'>
                            <h6 class = 'mx-auto center-text'>
                                written by <a href = 'https://github.com/katznboyz1'>katznboyz</a>
                            </h6>
                        </div>
                        <div class = 'd-flex justify-content-between form-group col-lg-6 col-md-12 mx-auto'>
                            <span class = 'text-nowrap my-auto px-1'>
                                <p class = 'my-auto'>Google Sheet URL</p>
                            </span>
                            <input type = 'text' id = 'google-sheet-url' class = 'form-control my-auto flex-grow-1' placeholder = 'Document ID (looks like aBcDefGHiJKlmnOPQrStUVwxYZ)'/>
                        </div>
                        <div class = 'd-flex form-group col-lg-6 col-md-12 mx-auto'>
                            <h6 class = 'mx-auto center-text'>
                                Please make sure that the Google Sheets URL you are using leads to a <b>public</b> Google Sheet.
                            </h6>
                        </div>
                        <div class = 'd-flex form-group col-lg-6 col-12-md mx-auto'>
                            <button class = 'btn btn-primary mx-auto' onclick = 'parseGoogleSheetURL();'>Verify Settings and Generate Cards Link</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>